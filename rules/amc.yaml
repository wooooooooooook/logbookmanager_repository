title: "서울아산병원-테스트 2022년이후 입국자용"
version: "2"
created_at: "2025-09-19T00:00:00Z"
updated_at: "2025-10-03T00:00:00Z"
description: |
  서울아산병원
  record2.radiology.or.kr 사이트 이용하는 2022년 이후 입국자
  2023년 개정 logbook 실태조사
  검사종류/검사명/부서/담당구분 기반 분류
  일부 분류 미흡한 버전
author: 
  name: "김영욱"
  email: "wooooooooooook@gmail.com"


column_mapping:
  required:
    - name: "고유번호"
      field: "id"
      type: "string"
      aliases: ["검사접수번호"]
    - name: "검사종류"
      field: "modality"
      type: "string"
      aliases: ["PACS장비구분코드_검사"]
    - name: "검사명"
      field: "exam_name"
      type: "string"
      aliases: ["검사코드_1"]
    - name: "판독실"
      field: "assign"
      type: "string"
      aliases: ["PACS판독실코드_New_1"]
    - name: "검사일"
      field: "study_date"
      type: "date"
      aliases: ["PACS검사일자"]
    - name: "판독일"
      field: "reading_date"
      type: "date"
      aliases: ["DICTATEDDATE"]
  optional:
    - name: "나이"
      field: "age"
      type: "number"
      aliases: ["AGE", "PATIENT_AGE", "Age"]
      description: "환자의 나이"
    - name: "환자성별"
      field: "sex"
      type: "string"
      aliases: ["SEX", "PATIENT_SEX", "환자성별(M/F)"]
      description: "환자의 성별 (M 또는 F)"
  default_order:
    - "reading_date"
    - "modality"
    - "exam_name"
    - "department"
    - "assign"
    - "sex"
    - "age"

categories: # 2023년 개정 logbook 실태조사
  - name: "미분류"
    id: "unclassified"
    description: "미분류 항목"
  - name: "데이터 보완 필요"
    id: "dataValidationRequired"
    description: "필수 필드가 누락되어 보완이 필요한 항목"
    subcategories:
      - name: "필수 필드 누락"
        id: "dataValidationRequired_required"
        description: "필수 필드가 누락된 항목"
      - name: "선택적 필드 누락"
        id: "dataValidationRequired_optional"
        description: "선택적 필드가 누락된 항목"
  - name: "일반촬영"
    id: "xray"
    target: 10000
    description: "일반촬영"
    subcategories:
      - name: "신경두경부"
        id: "xray_neu"
        target: 300
        description: "신경두경부"
      - name: "흉부"
        id: "xray_cht"
        target: 4000
        description: "흉부"
      - name: "복부"
        id: "xray_abd"
        target: 1000
        description: "복부"
      - name: "KUB"
        id: "xray_kub"
        target: 300
        description: "KUB"
      - name: "척추"
        id: "xray_spine"
        target: 1000
        description: "척추"
      - name: "관절 및 사지"
        id: "xray_msk"
        target: 2000
        description: "관절 및 사지"
      - name: "소아"
        id: "xray_ped"
        target: 400
        description: "소아"
        # subcategories:
        #   - name: "신경두경부"
        #     id: "xray_ped_neu"
        #     description: "소아 신경두경부"
        #   - name: "흉부"
        #     id: "xray_ped_cht"
        #     description: "소아 흉부"
        #   - name: "복부"
        #     id: "xray_ped_abd"
        #     description: "소아 복부"
        #   - name: "KUB"
        #     id: "xray_ped_kub"
        #     description: "KUB"
        #   - name: "척추"
        #     id: "xray_ped_spine"
        #     description: "소아 척추"
        #   - name: "관절 및 사지"
        #     id: "xray_ped_msk"
        #     description: "소아 관절 및 사지"
        #   - name: "기타"
        #     id: "xray_ped_etc"
        #     description: "소아 기타"
      - name: "기타"
        id: "xray_etc"
        description: "기타"
  - name: "유방촬영"
    id: "mammography"
    target: 300
    description: "유방촬영"
  - name: "CT"
    id: "ct"
    target: 3500
    description: "CT"
    subcategories:
      - name: "신경두경부"
        id: "ct_neu"
        target: 700
        description: "신경두경부"
      - name: "흉부"
        id: "ct_cht"
        target: 800
        description: "흉부"
      - name: "심장"
        id: "ct_cardiac"
        target: 100
        description: "심장"    
      - name: "혈관"
        id: "ct_vas"
        target: 100
        description: "혈관"    
      - name: "복부"
        id: "ct_abd"
        target: 800
        description: "복부"    
      - name: "비뇨생식기"
        id: "ct_gu"
        target: 300
        description: "비뇨생식기"    
      - name: "척추"
        id: "ct_spine"
        target: 100
        description: "척추"
      - name: "관절 및 사지"
        id: "ct_msk"
        target: 200
        description: "관절 및 사지"    
      - name: "소아"
        id: "ct_ped"
        target: 100
        description: "소아"
        # subcategories:
        #   - name: "신경두경부"
        #     id: "ct_ped_neu"
        #     description: "소아 신경두경부"
        #   - name: "흉부"
        #     id: "ct_ped_cht"
        #     description: "소아 흉부"
        #   - name: "심장"
        #     id: "ct_ped_cardiac"
        #     description: "소아 심장"
        #   - name: "혈관"
        #     id: "ct_ped_vas"
        #     description: "소아 혈관"    
        #   - name: "복부"
        #     id: "ct_ped_abd"
        #     description: "소아 복부"
        #   - name: "비뇨생식기"
        #     id: "ct_ped_gu"
        #     description: "소아 비뇨생식기"
        #   - name: "척추"
        #     id: "ct_ped_spine"
        #     description: "소아 척추"
        #   - name: "관절 및 사지"
        #     id: "ct_ped_msk"
        #     description: "소아 관절 및 사지"
        #   - name: "기타"
        #     id: "ct_ped_etc"
        #     description: "소아 기타"
      - name: "기타"
        id: "ct_etc"
        description: "기타"
  - name: "MRI"
    id: "mri"
    target: 1200
    description: "MRI"
    subcategories:
      - name: "신경두경부"
        id: "mri_neu"
        target: 550
        description: "신경두경부"
      - name: "심장"
        id: "mri_cardiac"
        target: 30
        description: "심장"
      - name: "복부"
        id: "mri_abd"
        target: 120
        description: "복부"    
      - name: "비뇨생식기"
        id: "mri_gu"
        target: 45
        description: "비뇨생식기"    
      - name: "척추"
        id: "mri_spine"
        target: 100
        description: "척추"    
      - name: "관절 및 사지"
        id: "mri_msk"
        target: 300
        description: "관절 및 사지"    
      - name: "유방"
        id: "mri_breast"
        target: 15
        description: "유방"    
      - name: "소아"
        id: "mri_ped"
        target: 30
        description: "소아"
        # subcategories:
        #   - name: "신경두경부"
        #     id: "mri_ped_neu"
        #     description: "소아 신경두경부"
        #   - name: "심장"
        #     id: "mri_ped_cardiac"
        #     description: "소아 심장"
        #   - name: "복부"
        #     id: "mri_ped_abd"
        #     description: "소아 복부"
        #   - name: "비뇨생식기"
        #     id: "mri_ped_gu"
        #     description: "소아 비뇨생식기"
        #   - name: "척추"
        #     id: "mri_ped_spine"
        #     description: "소아 척추"
        #   - name: "관절 및 사지"
        #     id: "mri_ped_msk"
        #     description: "소아 관절 및 사지"
        #   - name: "기타"
        #     id: "mri_ped_etc"
        #     description: "소아 기타"
      - name: "기타"
        id: "mri_etc"
        description: "기타"
    
  - name: "초음파"
    id: "ultrasound"
    target: 1300
    description: "초음파"
    subcategories:
      - name: "두경부"
        id: "ultrasound_head"
        target: 60
        description: "두경부"
      - name: "갑상선"
        id: "ultrasound_thyroid"
        target: 100
        description: "갑상선"
      - name: "복부"
        id: "ultrasound_abd"
        target: 500
        description: "복부"    
      - name: "비뇨기계"
        id: "ultrasound_gu"
        target: 150
        description: "비뇨기계"    
      - name: "근골격계"
        id: "ultrasound_msk"
        target: 20
        description: "근골격계"    
      - name: "유방"
        id: "ultrasound_breast"
        target: 150
        description: "유방"    
      - name: "소아"
        id: "ultrasound_ped"
        target: 100
        description: "소아"
        # subcategories:
        #   - name: "두경부"
        #     id: "ultrasound_ped_head"
        #     description: "소아 두경부"
        #   - name: "복부"
        #     id: "ultrasound_ped_abd"
        #     description: "소아 복부"
        #   - name: "비뇨기계"
        #     id: "ultrasound_ped_gu"
        #     description: "소아 비뇨기계"
        #   - name: "근골격계"
        #     id: "ultrasound_ped_msk"
        #     description: "소아 근골격계"
        #   - name: "기타"
        #     id: "ultrasound_ped_etc"
        #     description: "소아 기타"
      - name: "도플러"
        id: "ultrasound_doppler"
        target: 50
        description: "도플러"    
      - name: "기타"
        id: "ultrasound_etc"
        description: "기타"
  - name: "투시"
    id: "fluoroscopy"
    target: 80
    description: "투시"
    subcategories:
      - name: "복부"
        id: "fluoroscopy_abd"
        target: 1
        description: "복부"
      - name: "비뇨생식기계"
        id: "fluoroscopy_gu"
        target: 1
        description: "비뇨생식기계"
      - name: "소아"
        id: "fluoroscopy_ped"
        target: 1
        description: "소아"
        # subcategories:
        #   - name: "복부"
        #     id: "fluoroscopy_ped_abd"
        #     description: "소아 복부"
        #   - name: "비뇨생식기계"
        #     id: "fluoroscopy_ped_gu"
        #     description: "소아 비뇨생식기계"
        #   - name: "기타"
        #     id: "fluoroscopy_ped_etc"
        #     description: "소아 기타"
      - name: "기타"
        id: "fluoroscopy_etc"
        description: "기타"
    
  - name: "시술"
    id: "intervention"
    target: 150
    description: "시술"
    subcategories:
      - name: "뇌혈관조영술 및 주요 신경중재 치료"
        id: "intervention_neu"
        target: 1
        description: "뇌혈관조영술 및 주요 신경중재 치료"
      - name: "초음파 유도하 갑상선 침생검 또는 세침흡인술"
        id: "intervention_thyroid"
        target: 1
        description: "초음파 유도하 갑상선 침생검 또는 세침흡인술"
      - name: "초음파 유도하 경피적 생검"
        id: "intervention_us"
        target: 1
        description: "초음파 유도하 경피적 생검"    
      - name: "CT 유도하 경피적 생검"
        id: "intervention_ct"
        target: 1
        description: "CT 유도하 경피적 생검"    
      - name: "소아 장중첩증 정복술"
        id: "intervention_intu"
        target: 1
        description: "소아 장중첩증 정복술"    
      - name: "대퇴동맥천자술"
        id: "intervention_cfa"
        target: 1
        description: "대퇴동맥천자술"    
      - name: "대동맥 및 분지혈관에 대한 선택적 혈관조영술 및 혈관내 치료"
        id: "intervention_angio"
        target: 1
        description: "대동맥 및 분지혈관에 대한 선택적 혈관조영술 및 혈관내 치료"    
      - name: "경피적 담도계 배액술"
        id: "intervention_biliary"
        target: 1
        description: "경피적 담도계 배액술"    
      - name: "경피적신우배액술"
        id: "intervention_pcn"
        target: 1
        description: "경피적신우배액술"    
      - name: "그 외 경피적 배액술"
        id: "intervention_drain"
        target: 1
        description: "그 외 경피적 배액술"    
      - name: "중심정맥 카테터 삽입술"
        id: "intervention_cvc"
        target: 1
        description: "중심정맥 카테터 삽입술"
      - name: "영상유도하 종양치료"
        id: "intervention_tumor"
        target: 1
        description: "영상유도하 종양치료"
      - name: "기타"
        id: "intervention_etc"
        target: 0
        description: "기타"

  - name: "핵의학"
    id: "nuclearmedicine"
    target: 75
    description: "핵의학"
    subcategories:
      - name: "PET/CT"
        id: "nuclearmedicine_pet"
        target: 15
        description: "PET/CT"
      - name: "일반핵의학검사"
        id: "nuclearmedicine_other"
        target: 60
        description: "일반핵의학검사"

# 분류 기준 정의
classification_rules:
  # 데이터 검증 규칙 (최우선 적용)
  - category_id: dataValidationRequired
    name: "데이터 검증 필요"
    priority: 0
    conditions:
      - logic: OR
        conditions:
          - operator: is_null
            field: id
          - operator: is_null
            field: modality
          - operator: is_null
            field: exam_name
          - operator: is_null
            field: assign
          - operator: is_null
            field: reading_date
  - category_id: dataValidationRequired_required
    parent_category_id: dataValidationRequired
    name: "필수 필드 누락"
    priority: 0  # 최우선 적용
    conditions:
      - logic: OR
        conditions:
          - operator: is_null
            field: id
          - operator: is_null
            field: modality
          - operator: is_null
            field: exam_name
          - operator: is_null
            field: assign
          - operator: is_null
            field: reading_date
          - operator: is_null
            field: age
          - operator: is_null
            field: sex
  - category_id: dataValidationRequired_optional
    parent_category_id: dataValidationRequired
    name: "선택적 필드 누락"
    priority: 1  # 두 번째 우선순위
    conditions:
      - logic: AND
        conditions:
          # 필수 필드는 모두 있어야 함
          - operator: not_null
            field: id
          - operator: not_null
            field: modality
          - operator: not_null
            field: exam_name
          - operator: not_null
            field: assign
          - operator: not_null
            field: study_date
      - logic: OR
        conditions:
          # 선택적 필드 중 하나라도 누락
          - operator: is_null
            field: age
          - operator: is_null
            field: sex
  - category_id: xray
    name: "일반촬영"
    conditions:
      - operator: equals
        field: modality
        value: "CR"
  - category_id: xray_neu
    parent_category_id: xray
    name: "신경두경부"
    conditions:
      - logic: OR
        conditions:
          - operator: equals
            field: assign
            value: "Neuro"
      - logic: OR
        conditions:
          - operator: not_contains
            field: exam_name
            value: "Chest"
          - operator: not_contains
            field: exam_name
            value: "Abdomen"
          - operator: not_contains
            field: exam_name
            value: "Spine"
  - category_id: xray_cht
    parent_category_id: xray
    name: "흉부"
    conditions:
      - operator: contains
        field: exam_name
        value: "Chest"
  - category_id: xray_abd
    parent_category_id: xray
    name: "복부"
    conditions:
      - operator: contains
        field: exam_name
        value: "Abdomen"
  - category_id: xray_kub
    parent_category_id: xray
    name: "KUB"
    priority: 2
    conditions:
      - operator: contains
        field: exam_name
        value: "KUB"
        case_sensitive: true
  - category_id: xray_spine
    parent_category_id: xray
    name: "척추"
    priority: 2
    conditions:
      - operator: contains
        field: exam_name
        value: "Spine"
  - category_id: xray_msk
    parent_category_id: xray
    name: "관절 및 사지"
    conditions:
      - operator: equals
        field: assign
        value: "Musculoskeletal"
      - logic: OR
        conditions:
          - operator: not_contains
            field: exam_name
            value: "Chest"
          - operator: not_contains
            field: exam_name
            value: "Abdomen"
          - operator: not_contains
            field: exam_name
            value: "Spine"
  - category_id: xray_ped
    parent_category_id: xray
    name: "소아"
    priority: 1
    conditions:
      - operator: equals
        field: assign
        value: "Pediatrics"
  # - category_id: xray_ped_neu
  #   parent_category_id: xray_ped
  #   name: "신경두경부"
  #   inherit_conditions_from: xray_neu
  # - category_id: xray_ped_cht
  #   parent_category_id: xray_ped
  #   name: "흉부"
  #   inherit_conditions_from: xray_cht
  # - category_id: xray_ped_abd
  #   parent_category_id: xray_ped
  #   name: "복부"
  #   inherit_conditions_from: xray_abd
  # - category_id: xray_ped_kub
  #   parent_category_id: xray_ped
  #   name: "KUB"
  #   inherit_conditions_from: xray_kub
  # - category_id: xray_ped_spine
  #   parent_category_id: xray_ped
  #   name: "척추"
  #   inherit_conditions_from: xray_spine
  # - category_id: xray_ped_msk
  #   parent_category_id: xray_ped
  #   name: "관절 및 사지"
  #   inherit_conditions_from: xray_msk

  - category_id: mammography
    name: "유방촬영"
    priority: 2
    conditions:
      - operator: equals
        field: modality
        value: "MG"
  - category_id: ct
    name: "CT"
    conditions:
      - operator: equals
        field: modality
        value: "CT"
  - category_id: ct_neu
    parent_category_id: ct
    name: "신경두경부"
    conditions:
      - logic: OR
        conditions:
          - operator: equals
            field: assign
            value: "neuro"
          - operator: contains
            field: exam_name
            value: "brain"
          - operator: contains
            field: exam_name
            value: "facial"
          - operator: contains
            field: exam_name
            value: "head"
  - category_id: ct_cht
    parent_category_id: ct
    name: "흉부"
    conditions:
      - logic: OR
        conditions:
          - operator: equals
            field: assign
            value: "chest lung"
          - operator: contains
            field: exam_name
            value: "chest"
          - operator: contains
            field: exam_name
            value: "pulmonary embolism"
  - category_id: ct_cardiac
    parent_category_id: ct
    name: "심장"
    priority: 6
    conditions:
      - logic: OR
        conditions:
          - operator: equals
            field: assign
            value: "chest CV"
          - operator: contains
            field: exam_name
            value: "chest"
          - operator: contains
            field: exam_name
            value: "heart"
          - operator: contains
            field: exam_name
            value: "coronary artery"
      - logic: OR
        conditions:
          - operator: not_contains
            field: exam_name
            value: "aortic"
          - operator: not_contains
            field: exam_name
            value: "aorta"
          - operator: not_contains
            field: exam_name
            value: "angiography"
          - operator: not_contains
            field: exam_name
            value: "pulmonary vein"
  - category_id: ct_vas
    parent_category_id: ct
    name: "혈관"
    priority: 5
    conditions:
      - logic: OR
        conditions:
          - operator: contains
            field: exam_name
            value: "aortic"
          - operator: contains
            field: exam_name
            value: "aorta"
          - operator: contains
            field: exam_name
            value: "angiography"
          - operator: contains
            field: exam_name
            value: "pulmonary vein"
          - operator: contains
            field: exam_name
            value: "venography"
  - category_id: ct_abd
    parent_category_id: ct
    name: "복부"
    conditions:
      - logic: OR
        conditions:
          - operator: equals
            field: assign
            value: "Abdomen"
          - operator: contains
            field: exam_name
            value: "abdomen"
          - operator: contains
            field: exam_name
            value: "liver"
  - category_id: ct_gu
    parent_category_id: ct
    name: "비뇨생식기"
    priority: 2
    conditions:
      - logic: OR
        conditions:
          - operator: equals
            field: assign
            value: "Genitourinary"
          - operator: equals
            field: assign
            value: "OBGY"
  - category_id: ct_spine
    parent_category_id: ct
    name: "척추"    
    priority: 2
    conditions:
      - operator: contains
        field: exam_name
        value: "SPINE"
  - category_id: ct_msk
    parent_category_id: ct
    name: "관절 및 사지"
    conditions:
      - operator: equals
        field: assign
        value: "Musculoskeletal"
      - operator: not_contains
        field: exam_name
        value: "SPINE"
  - category_id: ct_ped
    parent_category_id: ct
    name: "소아"
    priority: 1
    conditions:
      - operator: equals
        field: assign
        value: "Pediatrics"
  # - category_id: ct_ped_neu
  #   parent_category_id: ct_ped
  #   name: "신경두경부"
  #   inherit_conditions_from: ct_neu
  # - category_id: ct_ped_cht
  #   parent_category_id: ct_ped
  #   name: "흉부"
  #   inherit_conditions_from: ct_cht
  # - category_id: ct_ped_abd
  #   parent_category_id: ct_ped
  #   name: "복부"
  #   inherit_conditions_from: ct_abd
  # - category_id: ct_ped_gu
  #   parent_category_id: ct_ped
  #   name: "비뇨생식기"
  #   inherit_conditions_from: ct_gu
  # - category_id: ct_ped_msk
  #   parent_category_id: ct_ped
  #   name: "관절 및 사지"
  #   inherit_conditions_from: ct_msk

  - category_id: mri
    name: "MRI"
    conditions:
      - operator: equals
        field: modality
        value: "MR"
  - category_id: mri_neu
    parent_category_id: mri
    name: "신경두경부"
    conditions:
      - logic: OR
        conditions:
          - operator: equals
            field: assign
            value: "Neuro"
          - operator: contains
            field: exam_name
            value: "brain"
          - operator: contains
            field: exam_name
            value: "diffusion"
          - operator: contains
            field: exam_name
            value: "stroke"
          - operator: contains
            field: exam_name
            value: "cranial"
      - operator: not_contains
        field: exam_name
        value: "SPINE"
  - category_id: mri_cardiac
    parent_category_id: mri
    name: "심장"
    conditions:
      - operator: contains
        field: exam_name
        value: "Cardio"
  - category_id: mri_abd
    parent_category_id: mri
    name: "복부"
    conditions:
      - operator: equals
        field: assign
        value: "Abdomen"
  - category_id: mri_gu
    parent_category_id: mri
    name: "비뇨생식기"
    conditions:
      - operator: equals
        field: assign
        value: "Genitourinary"
  - category_id: mri_spine
    parent_category_id: mri
    name: "척추"
    priority: 2
    conditions:
      - operator: contains
        field: exam_name
        value: "SPINE"
  - category_id: mri_msk
    parent_category_id: mri
    name: "관절 및 사지"
    priority: 3
    conditions:
      - operator: equals
        field: assign
        value: "Musculoskeletal"
      - operator: not_contains
        field: exam_name
        value: "SPINE"
  - category_id: mri_breast
    parent_category_id: mri
    name: "유방"
    conditions:
      - operator: equals
        field: assign
        value: "Breast"
  - category_id: mri_ped
    parent_category_id: mri
    name: "소아"
    priority: 1
    conditions:
      - operator: equals
        field: assign
        value: "Pediatrics"
  # - category_id: mri_ped_neu
  #   parent_category_id: mri_ped
  #   name: "신경두경부"
  #   inherit_conditions_from: mri_neu
  # - category_id: mri_ped_abd
  #   parent_category_id: mri_ped
  #   name: "복부"
  #   inherit_conditions_from: mri_abd
  # - category_id: mri_ped_spine
  #   parent_category_id: mri_ped
  #   name: "척추"
  #   inherit_conditions_from: mri_spine
  # - category_id: mri_ped_msk
  #   parent_category_id: mri_ped
  #   name: "관절 및 사지"
  #   inherit_conditions_from: mri_msk
  - category_id: ultrasound
    name: "초음파"
    conditions:
      - operator: equals
        field: modality
        value: "US"
      - logic: OR
        conditions:
          - operator: not_contains
            field: exam_name
            value: "유도"
          - operator: not_contains
            field: exam_name
            value: "고주파"
          - operator: not_contains
            field: exam_name
            value: "intussusception"
  - category_id: ultrasound_ped
    parent_category_id: ultrasound
    name: "소아"
    priority: 1
    conditions:
      - operator: equals
        field: assign
        value: "Pediatrics"
  # - category_id: ultrasound_ped_head
  #   parent_category_id: ultrasound_ped
  #   name: "두경부"
  #   inherit_conditions_from: ultrasound_head
  # - category_id: ultrasound_ped_abd
  #   parent_category_id: ultrasound_ped
  #   name: "복부"
  #   inherit_conditions_from: ultrasound_abd
  # - category_id: ultrasound_ped_gu
  #   parent_category_id: ultrasound_ped
  #   name: "비뇨기계"
  #   inherit_conditions_from: ultrasound_gu
  # - category_id: ultrasound_ped_msk
  #   parent_category_id: ultrasound_ped
  #   name: "근골격계"
  #   inherit_conditions_from: ultrasound_msk
  - category_id: ultrasound_head
    parent_category_id: ultrasound
    name: "두경부"
    conditions:
      - logic: OR
        conditions:
          - operator: equals
            field: assign
            value: "Neuro"
      - logic: OR
        conditions:
          - operator: not_contains
            field: exam_name
            value: "abdomen doppler"
          - operator: not_contains
            field: exam_name
            value: "carotid doppler"
          - operator: not_contains
            field: exam_name
            value: "color doppler"
  - category_id: ultrasound_thyroid
    parent_category_id: ultrasound
    name: "갑상선"
    conditions:
      - operator: contains
        field: exam_name
        value: "thyroid"
  - category_id: ultrasound_abd
    parent_category_id: ultrasound
    name: "복부"
    conditions:
      - operator: equals
        field: assign
        value: "Abdomen"
      - logic: OR
        conditions:
          - operator: not_contains
            field: exam_name
            value: "abdomen doppler"
          - operator: not_contains
            field: exam_name
            value: "color doppler"
  - category_id: ultrasound_gu
    parent_category_id: ultrasound
    name: "비뇨기계"
    conditions:
      - logic: OR
        conditions:
          - operator: equals
            field: assign
            value: "Genitourinary"
          - operator: equals
            field: assign
            value: "OBGY"
          - operator: contains
            field: exam_name
            value: "penis"
          - operator: contains
            field: exam_name
            value: "scrot"
          - operator: contains
            field: exam_name
            value: "생식기"
  - category_id: ultrasound_msk
    parent_category_id: ultrasound
    name: "근골격계"
    conditions:
      - operator: equals
        field: assign
        value: "Musculoskeletal"
  - category_id: ultrasound_breast
    parent_category_id: ultrasound
    name: "유방"
    conditions:
      - operator: equals
        field: assign
        value: "Breast"
  - category_id: ultrasound_doppler
    parent_category_id: ultrasound
    name: "도플러"
    priority: 2
    conditions:
      - logic: OR
        conditions:
          - operator: contains
            field: exam_name
            value: "abdomen doppler"
          - operator: contains
            field: exam_name
            value: "carotid doppler"
          - operator: contains
            field: exam_name
            value: "color doppler"
          - operator: contains
            field: exam_name
            value: "혈관도플러"
  - category_id: fluoroscopy
    name: "투시"
    priority: 3
    conditions:
      - operator: equals
        field: modality
        value: "DF"
  - category_id: fluoroscopy_abd
    parent_category_id: fluoroscopy
    name: "복부"
    conditions:
      - operator: equals  
        field: assign
        value: "Abdomen"
  - category_id: fluoroscopy_gu
    parent_category_id: fluoroscopy
    name: "비뇨생식기계"
    conditions:
      - logic: OR
        conditions:
          - operator: equals
            field: assign
            value: "Genitourinary"
          - operator: equals
            field: assign
            value: "OBGY"
  - category_id: fluoroscopy_ped
    parent_category_id: fluoroscopy
    name: "소아"
    conditions:
      - operator: equals
        field: assign
        value: "Pediatrics"

  # # 투시 소아 비고
  # - category_id: fluoroscopy_ped_abd
  #   parent_category_id: fluoroscopy_ped
  #   name: "복부"
  #   inherit_conditions_from: fluoroscopy_abd
  # - category_id: fluoroscopy_ped_gu
  #   parent_category_id: fluoroscopy_ped
  #   name: "비뇨생식기계"
  #   inherit_conditions_from: fluoroscopy_gu
  # - category_id: fluoroscopy_ped_etc
  #   parent_category_id: fluoroscopy_ped
  #   name: "기타"
  #   inherit_conditions_from: fluoroscopy_etc
  #   priority: 999
  # - category_id: fluoroscopy_etc
  #   parent_category_id: fluoroscopy
  #   name: "기타"
  #   conditions: []
  #   priority: 999

  - category_id: intervention
    name: "시술"
    priority: 1
    composed_by_subcategories: true
  - category_id: intervention_neu
    parent_category_id: intervention
    name: "뇌혈관조영술 및 주요 신경중재 치료"
    conditions:
      - logic: OR
        conditions:
          - operator: contains
            field: exam_name
            value: "뇌혈관조영술"
          - operator: contains
            field: exam_name
            value: "Vessel Angiography"
          - operator: contains
            field: exam_name
            value: "Internal Carotid Angiography"
          - operator: contains
            field: exam_name
            value: "신경중재"
  - category_id: intervention_thyroid
    parent_category_id: intervention
    name: "초음파 유도하 갑상선 침생검 또는 세침흡인술"
    priority: 5
    conditions:
      - logic: OR
        conditions:
          - operator: contains
            field: exam_name
            value: "갑상선"
          - operator: contains
            field: exam_name
            value: "thyroid"
      - logic: OR
        conditions:
          - operator: contains
            field: exam_name
            value: "biopsy"
          - operator: contains
            field: exam_name
            value: "aspiration"
  - category_id: intervention_us
    parent_category_id: intervention
    name: "초음파 유도하 경피적 생검"
    priority: 6
    conditions:
      - operator: equals
        field: modality
        value: "US"
      - logic: OR
        conditions:
          - operator: contains
            field: exam_name
            value: "생검"
          - operator: contains
            field: exam_name
            value: "조직검사"
          - operator: contains
            field: exam_name
            value: "biopsy"
  - category_id: intervention_ct
    parent_category_id: intervention
    name: "CT 유도하 경피적 생검"
    conditions:
      - operator: equals
        field: modality
        value: "CT"
      - logic: OR
        conditions:
          - operator: contains
            field: exam_name
            value: "생검"
          - operator: contains
            field: exam_name
            value: "조직검사"
          - operator: contains
            field: exam_name
            value: "biopsy"
  - category_id: intervention_intu
    parent_category_id: intervention
    name: "소아 장중첩증 정복술"
    conditions:
      - operator: contains
        field: exam_name
        value: "intussusception"
  - category_id: intervention_cfa
    parent_category_id: intervention
    name: "대퇴동맥천자술"
    conditions:
      - operator: contains
        field: exam_name
        value: "대퇴동맥천자술"
  - category_id: intervention_angio
    parent_category_id: intervention
    name: "대동맥 및 분지혈관에 대한 선택적 혈관조영술 및 혈관내 치료"
    conditions:
      - operator: equals
        field: modality
        value: "DS"
      - logic: OR
        conditions:
          - operator: contains
            field: exam_name
            value: "embolization"
          - operator: contains
            field: exam_name
            value: "arteriography"
          - operator: contains
            field: exam_name
            value: "transluminal angioplasty"
  - category_id: intervention_biliary
    parent_category_id: intervention
    name: "경피적 담도계 배액술"
    conditions:
      - operator: equals
        field: modality
        value: "DS"
      - logic: OR
        conditions:
          - operator: contains
            field: exam_name
            value: "transhepatic"
          - operator: contains
            field: exam_name
            value: "cholecystostomy"
          - operator: contains
            field: exam_name
            value: "biliary"
          - operator: contains
            field: exam_name
            value: "PTBD"
          - operator: contains
            field: exam_name
            value: "Cholecystostomy"
  - category_id: intervention_pcn
    parent_category_id: intervention
    name: "경피적신우배액술"
    conditions:
      - operator: equals
        field: modality
        value: "DS"
      - logic: OR
        conditions:
          - operator: contains
            field: exam_name
            value: "PCN"
          - operator: contains
            field: exam_name
            value: "Nephrostomy"
  - category_id: intervention_drain
    parent_category_id: intervention
    name: "그 외 경피적 배액술"
    priority: 11
    conditions:
      - logic: OR
        conditions:
          - operator: contains
            field: exam_name
            value: "drainage"
          - operator: contains
            field: exam_name
            value: "Chest tube"
  - category_id: intervention_cvc
    parent_category_id: intervention
    name: "중심정맥 카테터 삽입술"
    conditions:
      - operator: equals
        field: modality
        value: "DS"
      - logic: OR
        conditions:
          - operator: contains
            field: exam_name
            value: "catheter insertion"
          - operator: contains
            field: exam_name
            value: "PICC"
          - operator: contains
            field: exam_name
            value: "chemoport"
          - operator: contains
            field: exam_name
            value: "central line"
  - category_id: intervention_tumor
    parent_category_id: intervention
    name: "영상유도하 종양치료"
    conditions:
      - logic: OR
        conditions:
          - operator: contains
            field: exam_name
            value: "고주파"
          - operator: contains
            field: exam_name
            value: "sclerotherapy"
          - operator: contains
            field: exam_name
            value: "마이크로웨이브"
          - operator: contains
            field: exam_name
            value: "HIFU"
          - operator: contains
            field: exam_name
            value: "TACE"
  - category_id: intervention_etc
    parent_category_id: intervention
    name: "기타"
    priority: 999
    conditions:
      - operator: contains
        field: modality
        value: "DS"
  - category_id: nuclearmedicine
    name: "핵의학"
    conditions:
      - logic: OR
        conditions:
          - operator: contains
            field: modality
            value: "NM"
          - operator: contains
            field: modality
            value: "PT"
  - category_id: nuclearmedicine_pet
    parent_category_id: nuclearmedicine
    name: "PET/CT"
    conditions:
      - operator: contains
        field: modality
        value: "PT"
  - category_id: nuclearmedicine_other
    parent_category_id: nuclearmedicine
    name: "일반핵의학검사"
    conditions:
      - operator: contains
        field: modality
        value: "NM"
      - operator: not_contains
        field: modality
        value: "PT"

# 기본 분류 규칙 (위의 규칙에 해당하지 않는 경우)
default_classification:
  category_id: "unclassified"
  name: "미분류"
  description: "정의된 분류에 해당하지 않는 업무"
  color: "#95a5a6"

# 데이터 검증 규칙
validation_rules:
  required_fields:
    - "id"
    - "modality"
    - "exam_name"
    - "assign"
    - "study_date"
  field_types:
    id:
      type: "string"
    modality:
      type: "string"
    exam_name:
      type: "string"
    department:
      type: "string"
    assign:
      type: "string"
    age:
      type: "number"
      min: 0
      max: 150
    sex:
      type: "enum"
      values: ["M", "F"]
    reading_date:
      type: "date"
      format: "YYYY-MM-DD"
      allow_future: false

# CSV/Excel 내보내기 설정
export_as_sheet:
  default_format: "csv"  # 기본 내보내기 형식
  encoding: "utf-8"       # 파일 인코딩
  filename:
    pattern: "logbook_export_{date}_{time}"
    date_format: "YYYY-MM-DD"
    time_format: "HH-mm-ss"
  templates:
    - name: "for_record2"
      description: "record2 사이트 업로드용 (예시 엑셀 파일과 동일한 구조)"
      column_order: 
        - "serial_number"
        - "modality"
        - "specialty"
        - "sex"
        - "study_date"
        - "reading_date"
        - "exam_name"
      
      columns:
        # 일련번호 (자동 생성)
        - serial_number:
            name: "일련번호"
            type: "number"
            width: 8
            value:
              auto_increment:
                start_value: 1
                increment: 1
        
        # 검사종류 (메타데이터에서 가져오기)
        - modality:
            name: "검사종류"
            type: "string"
            width: 12
            value:
              from_metadata:
                key: examination_type_name
        
        # 세부전공 (조건부 로직으로 가져오기)
        - specialty:
            name: "세부전공"
            type: "string"
            width: 12
            value:
              from_metadata:
                key: "specialty_name"
                
        # 환자성별 (데이터 필드에서 가져오기)
        - sex:
            name: "환자성별(M/F)"
            type: "string"
            width: 8
            value:
              fallback_chain:
                - from_field:
                    field: "sex"
                - static:
                    value: "성별정보 없음"
        
        # 검사일 (데이터 필드에서 가져오기)
        - study_date:
            name: "검사일(년-월-일)"
            type: "date"
            width: 12
            date_format: "YYYY-MM-DD"
            value:
              fallback_chain:
                - from_field:
                    field: "study_date"
                - static:
                    value: "검사일 없음"
        
        # 판독일 (데이터 필드에서 가져오기)
        - reading_date:
            name: "판독일(년-월-일)"
            type: "date"
            width: 12
            date_format: "YYYY-MM-DD"
            value:
              from_field:
                field: "reading_date"
        
        # 검사명 (fallback chain으로 가져오기)
        - exam_name:
            name: "검사명"
            type: "string"
            width: 20
            value:
              fallback_chain:
                - from_field:
                    field: "exam_name"
                - static:
                    value: "검사명 없음"
      template_column_mapping:
        modality:
          "일반촬영":
            value: 1
            speciality:
              "신경두경부": 1
              "흉부": 2
              "복부": 3
              "비뇨생식기": 4
              "척추": 5
              "관절 및 사지": 6
              "소아": 12
              "기타": 999
          "CT": 
            value: 2
            speciality:
              "신경두경부": 1
              "흉부": 2
              "복부": 3
              "비뇨생식기": 4
              "척추": 5
              "관절 및 사지": 6
              "소아": 12
              "심장": 8
              "혈관": 9
              "기타": 999
          "MRI": 
            value: 3
            speciality:
              "신경두경부": 1
              "흉부": 2
              "복부": 3
              "비뇨생식기": 4
              "척추": 5
              "관절 및 사지": 6
              "소아": 12
              "유방": 7
              "심장": 8
              "혈관": 9
              "기타": 999
          "초음파": 
            value: 4
            speciality:
              "두경부": 1
              "복부": 3
              "비뇨기계": 4
              "근골격계": 6
              "유방": 7
              "갑상선": 10
              "도플러": 11
              "소아": 12
              "기타": 999
          "투시": 
            value: 5
            speciality:
              "복부": 3
              "비뇨생식기": 4
              "소아": 12
              "기타": 999
          "유방촬영": 
            value: 6
            speciality:
              "유방촬영": 1
          "핵의학": 
            value: 7
            speciality:
              "일반핵의학검사": 1
              "PET/CT": 2
          "시술": 
            value: 8
            speciality:
              "뇌혈관조영술 및 주요 신경중재 치료": 1
              "초음파 유도하 갑상선 침생검 또는 세침흡인술": 2
              "초음파 유도하 경피적 생검(유방, 복부, 신장, 전립선, 근골격 등)": 3
              "CT 유도하 경피적 생검 (폐, 신장 등)": 4
              "소아 장중첩증 정복술": 5
              "대퇴동맥천자술": 6
              "대동맥 및 분지혈관에 대한 선택적 혈관조영술 및 혈관내 치료(TACE, UAE, BAE 등 각 종 transarterial embolization 및 endovascular treatment 시술 포함)": 7
              "경피적 담도계 배액술 (담관배액술 또는 담낭배액술 등)": 8
              "경피적신우배액술": 9
              "그 외 경피적 배액술 (흉수천자, 복수천자, 농양천자 등)": 10
              "중심정맥 카테터 삽입술": 11
              "영상유도하 종양치료 (알코올경화술, 고주파열치료, 마이크로웨이브, HIFU 등)": 12
              "기타": 999
      ajax_template: |
        $.ajax({
          url: "/major/reading/handle/reading_A_upsert.php",
          type: "POST",
          data: {
            sid: "",
            gubun: {{modality}},
            kind: {{specialty}},
            reading_count: {{count}},
            sdate: "{{start_date}}",
            edate: "{{end_date}}"
          },
          dataType: "text",
          success: function(e) {
            console.log("{{modality}} | {{specialty}} 업로드 완료");
          }
        });